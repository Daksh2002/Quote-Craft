<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QuoteCraft</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container py-3">
        <div class="row justify-content-end">
            <div class="col-auto">
                <button id="darkModeToggle" class="btn btn-outline-secondary mb-2">üåô Dark Mode</button>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-12 col-md-8">
                <div class="quote-card card shadow-lg p-4 mt-3">
                    <h2 class="mb-4 text-center gradient-text">QuoteCraft</h2>
                    <div class="mb-3">
                        <select id="mood" class="form-select">
                            <option value="">Select Mood</option>
                            <option value="spiritual">Spiritual</option>
                            <option value="dharmic">Dharmic</option>
                            <option value="motivational">Motivational</option>
                            <option value="funny">Funny</option>
                            <option value="random">Random</option>
                            <option value="ai">AI Quote</option>
                        </select>
                    </div>
                    <button id="getQuoteBtn" class="btn btn-primary w-100">Get Quote</button>
                    <div class="text-center mt-3">
                        <div class="spinner-border text-primary" role="status" id="loadingSpinner" style="display:none;"></div>
                    </div>
                    <div id="quoteDisplay" class="mt-4 text-center fade-in"></div>
                </div>
            </div>
        </div>
        <footer class="footer mt-4" id="mainFooter">
            <span style="font-size:1.1em;">&copy;</span> Daksh
            <span id="year"></span>
            <span style="margin-left:10px;">
                All Rights Reserved
            </span>
        </footer>
    </div>
    <script>
        document.getElementById('year').textContent = new Date().getFullYear();

        function setFooterColor(isDark) {
            const footer = document.getElementById('mainFooter');
            footer.style.color = isDark ? "#fff" : "#222";
        }

        function setGradient(category, darkMode) {
            let gradient;
            if (darkMode) {
                if (category === "spiritual") gradient = "linear-gradient(120deg, #232526 0%, #6e45e2 100%)";
                else if (category === "motivational") gradient = "linear-gradient(120deg, #232526 0%, #f7971e 100%)";
                else if (category === "funny") gradient = "linear-gradient(120deg, #232526 0%, #ff6a00 100%)";
                else if (category === "ai") gradient = "linear-gradient(120deg, #232526 0%, #00b894 100%)";
                else gradient = "linear-gradient(120deg, #232526 0%, #414345 100%)";
            } else {
                if (category === "spiritual") gradient = "linear-gradient(120deg, #f5f6fa 0%, #6e45e2 100%)";
                else if (category === "motivational") gradient = "linear-gradient(120deg, #f5f6fa 0%, #f7971e 100%)";
                else if (category === "funny") gradient = "linear-gradient(120deg, #f5f6fa 0%, #ff6a00 100%)";
                else if (category === "ai") gradient = "linear-gradient(120deg, #f5f6fa 0%, #00b894 100%)";
                else gradient = "linear-gradient(120deg, #f5f6fa 0%, #dff9fb 100%)";
            }
            document.body.style.background = gradient;
            setFooterColor(darkMode);
        }

        document.getElementById('getQuoteBtn').onclick = async function() {
            const mood = document.getElementById('mood').value;
            const spinner = document.getElementById('loadingSpinner');
            const display = document.getElementById('quoteDisplay');
            display.innerHTML = '';
            spinner.style.display = 'inline-block';
            try {
                const res = await fetch('/get-quote', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ mood })
                });
                const data = await res.json();
                display.innerHTML = `<blockquote class="blockquote"><p>${data.quote}</p></blockquote>
                    <footer class="blockquote-footer">${data.author}</footer>`;
                display.classList.remove('fade-in');
                void display.offsetWidth;
                display.classList.add('fade-in');
                display.dataset.category = data.category;
                setGradient(data.category, document.body.classList.contains('dark-mode'));
            } catch (err) {
                display.innerHTML = '<span class="text-danger">Error fetching quote.</span>';
            }
            spinner.style.display = 'none';
        };

        // Dark mode toggle
        const toggleBtn = document.getElementById('darkModeToggle');
        toggleBtn.onclick = function() {
            document.body.classList.toggle('dark-mode');
            if(document.body.classList.contains('dark-mode')) {
                toggleBtn.textContent = "‚òÄÔ∏è Light Mode";
            } else {
                toggleBtn.textContent = "üåô Dark Mode";
            }
            // Reapply gradient and footer color for current mode
            const display = document.getElementById('quoteDisplay');
            const category = display.dataset.category || "spiritual";
            setGradient(category, document.body.classList.contains('dark-mode'));
        };

        // Set initial footer color
        setFooterColor(document.body.classList.contains('dark-mode'));
    </script>
</body>
</html>
